<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}  {# for add_class filter #}
{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'core/css/add_product.css' %}"/>

<div class="breadcrumb-container">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li>
        <li class="breadcrumb-item"><a href="{% url 'staffPanel' %}">Account</a></li>
        <li class="breadcrumb-item active" aria-current="page"><a href="{% url 'add_product' %}" style="color: dimgray">Add New Product</a></li>
      </ol>
    </nav>
</div>

<div class="add-product-container">
    <h2 class="fw-bold mb-4">Add New Product</h2>
    <hr>
    <form method="POST" enctype="multipart/form-data" class="fw-bold mt-3">
        {% csrf_token %}

<!--        {% if form.errors %}-->
<!--        <div class="alert alert-danger">-->
<!--          <ul class="mb-0">-->
<!--            &lt;!&ndash; Field errors &ndash;&gt;  -->
<!--            {% for field in form %}-->
<!--              {% for error in field.errors %}-->
<!--                <li><strong>{{ field.label }}:</strong> {{ error }}</li>-->
<!--              {% endfor %}-->
<!--            {% endfor %}-->
<!--              -->
<!--            &lt;!&ndash; Non-field errors (e.g. category logic) &ndash;&gt;  -->
<!--            {% for error in form.non_field_errors %}-->
<!--              <li>{{ error }}</li>-->
<!--            {% endfor %}-->
<!--          </ul>-->
<!--        </div>-->
<!--        {% endif %}-->

        <!-- Global form error -->
        {% if form.errors %}
          <div class="alert alert-danger">
              Please correct the error below.
          </div>
        {% endif %}

        <!-- Non-field errors (e.g. category logic) -->
        {% if form.non_field_errors %}
        <div class="alert alert-danger">
          <ul class="mb-0">
            {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}

        <!-- Category -->
        <label>Category:</label>
        <div class="form-control fw-bold mb-3">
            <div class="row mt-3 mb-3">
                <div class="col-md-6">
                    <label class="form-label">{{ form.existing_category.label }}</label>
                    {{ form.existing_category }}
                    {% if form.existing_category.errors %}
                        <div class="text-danger small">{{ form.existing_category.errors }}</div>
                    {% endif %}
                </div>
                <div class="col-md-6">
                    <label class="form-label">{{ form.new_category.label }}</label>
                        {{ form.new_category }}
                        {% if form.new_category.errors %}
                            <div class="text-danger small">{{ form.new_category.errors }}</div>
                        {% endif %}
                </div>
            </div>
        </div>

        <!-- Example field rendering -->
        <!-- Product Name -->
        <div class="mb-3">
          {{ form.name.label_tag }}
          {% if form.name.errors %}
            {{ form.name|add_class:"form-control is-invalid" }}
            <div class="text-danger">
              {% for error in form.name.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% else %}
            {{ form.name|add_class:"form-control" }}
          {% endif %}
        </div>

        <!-- Repeating the same pattern for other fields... -->
        <!-- Custom Slug -->
        <div class="mb-3">
          {{ form.slug.label_tag }}
          {% if form.slug.errors %}
            {{ form.slug|add_class:"form-control is-invalid" }}
            <div class="text-danger">
              {% for error in form.slug.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% else %}
            {{ form.slug|add_class:"form-control" }}
          {% endif %}
        </div>

        <!-- Example with two fields side by side -->
        <!-- Brand + Model -->
        <div class="row">
          <div class="col-md-6 mb-3">
            {{ form.brand.label_tag }}
            {% if form.brand.errors %}
              {{ form.brand|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.brand.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.brand|add_class:"form-control" }}
            {% endif %}
          </div>
          <div class="col-md-6 mb-3">
            {{ form.model.label_tag }}
            {% if form.model.errors %}
              {{ form.model|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.model.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.model|add_class:"form-control" }}
            {% endif %}
          </div>
        </div>

        <!-- Color + Product Code -->
        <div class="row">
          <div class="col-md-6 mb-3">
            {{ form.color.label_tag }}
            {% if form.color.errors %}
              {{ form.color|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.color.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.color|add_class:"form-control" }}
            {% endif %}
          </div>
          <div class="col-md-6 mb-3">
            {{ form.product_code.label_tag }}
            {% if form.product_code.errors %}
              {{ form.product_code|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.product_code.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.product_code|add_class:"form-control" }}
            {% endif %}
          </div>
        </div>

        <!-- Specification -->
        <div class="mb-3">
          {{ form.specification.label_tag }}
          {% if form.specification.errors %}
            {{ form.specification|add_class:"form-control is-invalid" }}
            <div class="text-danger">
              {% for error in form.specification.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% else %}
            {{ form.specification|add_class:"form-control" }}
          {% endif %}
        </div>

        <!-- Description -->
        <div class="mb-3">
          {{ form.description.label_tag }}
          {% if form.description.errors %}
            {{ form.description|add_class:"form-control is-invalid" }}
            <div class="text-danger">
              {% for error in form.description.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% else %}
            {{ form.description|add_class:"form-control" }}
          {% endif %}
        </div>

        <!-- Prices -->
        <div class="row">
          <div class="col-md-6 mb-3">
            {{ form.regular_price.label_tag }}
            {% if form.regular_price.errors %}
              {{ form.regular_price|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.regular_price.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.regular_price|add_class:"form-control" }}
            {% endif %}
          </div>
          <div class="col-md-6 mb-3">
            {{ form.special_price.label_tag }}
            {% if form.special_price.errors %}
              {{ form.special_price|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.special_price.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.special_price|add_class:"form-control" }}
            {% endif %}
          </div>
        </div>

        <!-- Stock + Status -->
        <div class="row">
          <div class="col-md-5 mb-3">
            {{ form.stock.label_tag }}
            {% if form.stock.errors %}
              {{ form.stock|add_class:"form-control is-invalid" }}
              <div class="text-danger small">
                {% for error in form.stock.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.stock|add_class:"form-control" }}
            {% endif %}
          </div>
          <div class="col-md-5 mb-3 ms-4 py-2 shadow-sm">
            {{ form.status.label_tag }}
            {% if form.status.errors %}
              {{ form.status|add_class:"form-control is-invalid" }}
              <div class="text-danger small">
                {% for error in form.status.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.status|add_class:"form-control" }}
            {% endif %}
          </div>
        </div>

         <!-- Warranty + Warranty Details -->
        <div class="row">
          <div class="col-md-6 mb-3">
            {{ form.warranty.label_tag }}
            {% if form.warranty.errors %}
              {{ form.warranty|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.warranty.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.warranty|add_class:"form-control" }}
            {% endif %}
          </div>
          <div class="col-md-6 mb-3">
            {{ form.warranty_details.label_tag }}
            {% if form.warranty_details.errors %}
              {{ form.warranty_details|add_class:"form-control is-invalid" }}
              <div class="text-danger">
                {% for error in form.warranty_details.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% else %}
              {{ form.warranty_details|add_class:"form-control" }}
            {% endif %}
          </div>
        </div>

        <!-- Product Image -->
        <div class="mb-3">
          {{ form.product_image.label_tag }}
          {% if form.product_image.errors %}
            {{ form.product_image|add_class:"form-control is-invalid" }}
            <div class="text-danger">
              {% for error in form.product_image.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% else %}
            {{ form.product_image|add_class:"form-control" }}
          {% endif %}
        </div>

        <!-- Confirm checkbox -->
        <div class="form-check form-switch mt-4 mb-4">
            <input class="form-check-input" type="checkbox" value="checkbox" name="confirm" id="confirm" required>
            <label class="form-check-label" for="confirm">Confirm</label>
        </div>

        <!-- Submit -->
        <div class="text-center">
            <button type="submit" class="button" style="margin-top: 15px; width: 385px;">
                <span>Save Product</span>
            </button>
        </div>
    </form>

    <div class="text-center">
        <a href="{% url 'staffPanel' %}">
            <button class="button2" style="margin-top: 15px; width: 385px;">
                <span>Back</span>
            </button>
        </a>
    </div>
</div>
{% endblock %}
{% block extra_js %}
<!-- Select2 CSS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
<!-- jQuery (needed for Select2) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Select2 JS -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="{% static 'core/js/add_product.js' %}"></script>
{% endblock %}